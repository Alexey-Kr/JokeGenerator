document.addEventListener("DOMContentLoaded",(function(){const e="chuckIds69",t=document.querySelector("form"),a=document.querySelector(".joke-request-value"),o=document.querySelector(".search_input"),c=document.querySelector(".jokes-block"),s=document.querySelector(".jokes-msg"),i=document.querySelectorAll("input[type='radio']"),n=document.querySelectorAll("label");console.log("sd");function r(t,a="standard"){let o=document.createElement("div"),c=`<div class="joke_meta">\n                <div class="joke_time">\n                    <div class="joke_time-meta">Last update:</div>\n                    <div class="joke_time-value">${(e=>{let t=new Date(e).getTime(),a=(new Date).getTime()-t;return Math.floor(a/1e3/60/60)})(t.updated_at)} hours ago</div>\n                </div>`;var s;c+=t.categories.length>0&&"standard"==a?`<div class="joke_category">${t.categories}</div></div>`:"</div>";let i=`<div ${"standard"==a?"":`id="${e}${t.id}"`} class="joke-card joke-card-${a} ${s=t.id,localStorage.getItem(e+s)?"card-favorite":""}" data-id="${e}${t.id}">\n                <div class="btn-favorite"></div>\n                <div class="joke_body">\n                    <div class="joke_link">\n                        <span class="joke_link-title">ID:</span>\n                        <a href="${t.url}" class="joke-link">${t.id}</a>\n                    </div>\n                    <div class="joke_text">${t.value}</div>\n                    ${c}\n                </div>\n            </div>`;return o.innerHTML=i,u(o.firstElementChild.querySelector(".btn-favorite"),t),o.firstElementChild}i.forEach((e=>{e.addEventListener("change",(e=>{const{target:t}=e;"categories"!=t.id||document.querySelector(".categories-block .categories_item")?a.value="":d()}))})),o.addEventListener("keyup",(e=>{e.isComposing||229===e.keyCode||(a.value=e.target.value)})),t.addEventListener("submit",(async e=>{e.preventDefault();let t="https://api.chucknorris.io/jokes/"+document.querySelector("input[name=queryType]:checked").value+a.value;s.innerHTML="";await fetch(t).then((e=>e.json())).then((e=>{let t=[];void 0!==e.total&&null!==e.total?(s.innerHTML=`We found ${e.total} joke(s) with "${a.value}"`,e.result.forEach((e=>{t.push(r(e))}))):t.push(r(e)),c.innerHTML="",t.forEach((e=>{c.append(e)}))}))}));Object.keys(localStorage).forEach((t=>{if(-1!==t.indexOf(e)){let e=r(JSON.parse(localStorage.getItem(t)),"mini");document.querySelector("aside").append(e)}}));const d=async()=>{const e=await fetch("https://api.chucknorris.io/jokes/categories"),t=await e.json();let o="";t.forEach(((e,t)=>{0==t?(a.value=e,o+='<div class="categories_item active">'+e+"</div>"):o+='<div class="categories_item">'+e+"</div>"})),document.querySelector(".categories-block").innerHTML=o};(async()=>{await fetch("https://api.chucknorris.io/jokes/random").then((e=>e.json())).then((e=>{let t=r(e);document.querySelector(".jokes-block").append(t)}))})(),document.addEventListener("click",(e=>{const{target:t}=e;t.closest(".categories_item")&&(l(),t.classList.add("active"),a.value=t.textContent)}));const l=()=>{document.querySelectorAll(".categories_item").forEach((e=>{e.classList.remove("active")}))};function u(e,t=[]){e.addEventListener("click",(e=>{const{target:a}=e;let o=a.parentNode,c=o.dataset.id;if(o.classList.contains("card-favorite")){document.querySelectorAll('[data-id="'+c+'"]').forEach((e=>{e.classList.remove("card-favorite")})),localStorage.removeItem(c),console.log("#"+c),document.querySelector("#"+c).remove()}else{o.classList.add("card-favorite");let e=o.cloneNode(!0);e.className="joke-card joke-card-mini card-favorite",e.id=c,u(e),localStorage.setItem(c,JSON.stringify(t)),document.querySelector("aside").append(e)}}))}n.forEach((e=>{e.addEventListener("click",(e=>{const{target:a}=e;t.className="",t.classList.add(a.dataset.formClass),window.setTimeout((()=>o.focus()),0)}))})),document.addEventListener("click",(e=>{const{target:t}=e;t.closest(".mob-menu-toggle")&&document.body.classList.toggle("menu-show")}))}));