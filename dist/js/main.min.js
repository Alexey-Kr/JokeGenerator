document.addEventListener("DOMContentLoaded",(function(){const e="chuckIds69",t=document.querySelector("form"),a=document.querySelector(".joke-request-value"),o=document.querySelector(".search_input"),c=document.querySelector(".jokes-block"),s=document.querySelector(".jokes-msg"),i=document.querySelectorAll("input[type='radio']"),r=document.querySelectorAll("label"),n=(e,t=[])=>{e.addEventListener("click",(e=>{const{target:a}=e;let o=a.parentNode,c=o.dataset.id;if(o.classList.contains("card-favorite")){document.querySelectorAll('[data-id="'+c+'"]').forEach((e=>{e.classList.remove("card-favorite")})),localStorage.removeItem(c),document.querySelector("#"+c).remove()}else{o.classList.add("card-favorite");let e=o.cloneNode(!0);e.className="joke-card joke-card-mini card-favorite",e.id=c,n(e),localStorage.setItem(c,JSON.stringify(t)),document.querySelector("aside").append(e)}}))},d=(t,a="standard")=>{let o=document.createElement("div"),c=`<div class="joke_meta">\n                <div class="joke_time">\n                    <div class="joke_time-meta">Last update:</div>\n                    <div class="joke_time-value">${(e=>{let t=new Date(e).getTime(),a=(new Date).getTime()-t;return Math.floor(a/1e3/60/60)})(t.updated_at)} hours ago</div>\n                </div>`;c+=t.categories.length>0&&"standard"===a?`<div class="joke_category">${t.categories}</div></div>`:"</div>";let s="standard"===a?"":`id="${e}${t.id}"`,i=(r=t.id,localStorage.getItem(e+r)?"card-favorite":"");var r;o.innerHTML=`<div ${s} class="joke-card joke-card-${a} ${i}" data-id="${e}${t.id}">\n                <div class="btn-favorite"></div>\n                <div class="joke_body">\n                    <div class="joke_link">\n                        <span class="joke_link-title">ID:</span>\n                        <a href="${t.url}" class="joke-link">${t.id}</a>\n                    </div>\n                    <div class="joke_text">${t.value}</div>\n                    ${c}\n                </div>\n            </div>`;let d=o.firstElementChild.querySelector(".btn-favorite");return n(d,t),o.firstElementChild};t.addEventListener("submit",(async e=>{e.preventDefault();let o=document.querySelector("input[name=queryType]:checked").value,i="https://api.chucknorris.io/jokes/"+o+a.value;o.includes("search")&&a.value.length<4?t.classList.add("show-search-msg"):(s.innerHTML="",await fetch(i).then((e=>e.json())).then((e=>{let t=[];void 0!==e.total&&null!==e.total?(s.innerHTML=`We found ${e.total} joke(s) with "${a.value}"`,e.result.forEach((e=>{t.push(d(e))}))):t.push(d(e)),c.innerHTML="",t.forEach((e=>{c.append(e)}))})))})),o.addEventListener("keyup",(e=>{e.isComposing||229===e.keyCode||(a.value=e.target.value)})),i.forEach((e=>{e.addEventListener("change",(e=>{const{target:t}=e;switch(t.id){case"categories":document.querySelector(".categories-block .categories_item")?a.value=document.querySelector(".categories_item.active").textContent:(async()=>{const e=await fetch("https://api.chucknorris.io/jokes/categories"),t=await e.json();let o="";t.forEach(((e,t)=>{0===t?(a.value=e,o+='<div class="categories_item active">'+e+"</div>"):o+='<div class="categories_item">'+e+"</div>"})),document.querySelector(".categories-block").innerHTML=o})();break;case"random":a.value="";break;case"search":a.value=o.value}}))})),r.forEach((e=>{e.addEventListener("click",(e=>{const{target:a}=e;t.className="",t.classList.add(a.dataset.formClass),window.setTimeout((()=>o.focus()),0)}))})),document.addEventListener("click",(e=>{const{target:t}=e;t.closest(".categories_item")&&(document.querySelectorAll(".categories_item").forEach((e=>{e.classList.remove("active")})),t.classList.add("active"),a.value=t.textContent)})),document.addEventListener("click",(e=>{const{target:t}=e;t.closest(".mob-menu-toggle")&&document.body.classList.toggle("menu-show")})),Object.keys(localStorage).forEach((t=>{if(-1!==t.indexOf(e)){let e=d(JSON.parse(localStorage.getItem(t)),"mini");document.querySelector("aside").append(e)}})),(async()=>{await fetch("https://api.chucknorris.io/jokes/random").then((e=>e.json())).then((e=>{let t=d(e);document.querySelector(".jokes-block").append(t)}))})()}));